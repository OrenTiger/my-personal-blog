@using MyPersonalBlog.Models
@using PagedList.Mvc;
@using MyPersonalBlog.Infrastructure
@model  PagedList.IPagedList<Post>

@{
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<h4>Все записи</h4>

<table class="table table-striped">
    <thead>
        <tr>
            <th><a href="@Url.Current(new { order = ViewBag.Order })">ID</a></th>
            <th>Заголовок</th>
            <th><a href="@Url.Current(new { order = ViewBag.DateOrder })">Дата создания</a></th>
            <th>Опубликован</th>
            <th colspan="3" class="text-center">Действия</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var post in Model)
        {
            <tr>
                <td>@post.Id</td>
                <td>@post.Title</td>
                <td>@post.CreateDate</td>
                <td class="text-center">@Html.CheckBoxFor(p => post.Published, new { @class = "checkbox checkbox-inline", disabled = "disabled" })</td>
                <td><a class="btn btn-success btn-sm" href="@Url.Action("Edit", "Posts", new { id = @post.Id})"><span class="glyphicon glyphicon-edit"></span> Редактировать</a></td>
                <td><a class="btn btn-info btn-sm" href="javascript:showFastView(@post.Id)"><span class="glyphicon glyphicon-eye-open"></span> Просмотреть</a></td>
                <td><a class="btn btn-danger btn-sm" href="@Url.Action("Edit", "Posts", new { id = @post.Id})"><span class="glyphicon glyphicon-remove"></span> Удалить</a></td>
            </tr>
        }
    </tbody>
</table>

<br />

<div class="container-fluid">
    <div class="row">
        <div class="col-sm-4"><a class="btn btn-success" href="@Url.Action("Edit", "Posts")"><span class="glyphicon glyphicon-pencil"></span> Новый пост</a></div>
        <div class="col-sm-4">@Html.PagedListPager(Model, page => Url.Current(new { page }).ToString())</div>
        <div class="col-sm-4">
            <span>Неопубликованные: </span>
            <a class="btn btn-info btn-xs @Html.IsSetParameter("published", null, "active")" href="@Url.Current(new { published = "" })">Показать</a>
            <a class="btn btn-warning btn-xs @Html.IsSetParameter("published", "hide", "active")" href="@Url.Current(new { published = "hide", page = "" }) ">Скрыть</a>
        </div>
    </div>
</div>

<div id="fastView" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg">

        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dissmiss="modal">&times;</button>
                <h4 class="modal-title">Быстрый просмотр</h4>
            </div>
            <div class="modal-body" id="fastViewContent">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
            </div>
        </div>

    </div>
</div>

<script type="text/javascript">
    function showFastView(id) {
        var currentId = id;
        var getUrl = '@Url.Action("FastView")';
        $('#fastViewContent').html('<p>Загрузка содержимого...</p>');
        $('#fastViewContent').load(getUrl, { 'id': currentId });
        $('#fastView').modal('show');
    }
</script>